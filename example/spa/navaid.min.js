/**
 * The MIT License (MIT)
 * 
 * Copyright (c) Luke Edwards <luke.edwards05@gmail.com> (lukeed.com)
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
 
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.navaid=t()}(this,function(){function e(e,t){history[e]||(history[e]=e,t=history[e+="State"],history[e]=function(n){var r=new Event(e.toLowerCase());return r.uri=n,t.apply(this,arguments),dispatchEvent(r)})}return function(t,n){var r,s,i=[],a={},u=a.format=function(e){return e?(e="/"+e.replace(/^\/|\/$/g,""),r.test(e)&&e.replace(r,"/")):e};return t="/"+(t||"").replace(/^\/|\/$/g,""),r="/"==t?/^\/+/:new RegExp("^\\"+t+"(?=\\/|$)\\/?","i"),a.route=function(e,n){"/"!=e[0]||r.test(e)||(e=t+e),history[(e===s||n?"replace":"push")+"State"](e,null,e)},a.on=function(e,t){return(e=function(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,r,s,i,a=[],u="",o=e.split("/");for(o[0]||o.shift();s=o.shift();)"*"===(n=s[0])?(a.push("wild"),u+="/(.*)"):":"===n?(r=s.indexOf("?",1),i=s.indexOf(".",1),a.push(s.substring(1,~r?r:~i?i:s.length)),u+=~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(u+=(~r?"?":"")+"\\"+s.substring(i))):u+="/"+s;return{keys:a,pattern:new RegExp("^"+u+"/?$","i")}}(e)).fn=t,i.push(e),a},a.run=function(e){var t,r,o=0,c={};if(e=u(e||location.pathname)){for(e=e.match(/[^\?#]*/)[0],s=e;o<i.length;o++)if(t=(r=i[o]).pattern.exec(e)){for(o=0;o<r.keys.length;)c[r.keys[o]]=t[++o]||null;return r.fn(c),a}n&&n(e)}return a},a.listen=function(t){function n(e){a.run()}function s(e){var t=e.target.closest("a"),n=t&&t.getAttribute("href");e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button||e.defaultPrevented||n&&!t.target&&t.host===location.host&&"#"!=n[0]&&("/"!=n[0]||r.test(n))&&(e.preventDefault(),a.route(n))}return e("push"),e("replace"),addEventListener("popstate",n),addEventListener("replacestate",n),addEventListener("pushstate",n),addEventListener("click",s),a.unlisten=function(){removeEventListener("popstate",n),removeEventListener("replacestate",n),removeEventListener("pushstate",n),removeEventListener("click",s)},a.run(t)},a};});